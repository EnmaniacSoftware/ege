#include <EGEMutex.h>
#include <EGEDebug.h>

#ifdef EGE_THREAD_PTHREAD
#include "Core/Thread/PThread/Mutex_p.h"
#endif // EGE_THREAD_PTHREAD

EGE_NAMESPACE

//--------------------------------------------------------------------------------------------------------------------------------------------------------------
EGE_DEFINE_NEW_OPERATORS(Mutex)
EGE_DEFINE_DELETE_OPERATORS(Mutex)
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
Mutex::Mutex(Application* app) : Object(app, EGE_OBJECT_UID_MUTEX)
{
  m_p = ege_new MutexPrivate(this);
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
Mutex::~Mutex()
{
  EGE_DELETE(m_p);
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
/*! Returns TRUE if object is valid. */
bool Mutex::isValid() const
{
  return (NULL != m_p);
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
/*! Locks mutex. */
bool Mutex::lock()
{
  EGE_ASSERT(isValid());
  if (m_p)
  {
    return m_p->lock();
  }

  return false;
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
/*! Unlocks mutex. */
bool Mutex::unlock()
{
  EGE_ASSERT(isValid());
  if (m_p)
  {
    return m_p->unlock();
  }

  return false;
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
