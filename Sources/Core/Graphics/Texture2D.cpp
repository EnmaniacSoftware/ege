#include "Core/Graphics/Texture2D.h"
#include "Core/Application/Application.h"
#include "Core/Graphics/Graphics.h"
#include "Core/Graphics/Render/RenderSystem.h"
#include "EGEDebug.h"

EGE_NAMESPACE

//--------------------------------------------------------------------------------------------------------------------------------------------------------------
EGE_DEFINE_NEW_OPERATORS(Texture2D)
EGE_DEFINE_DELETE_OPERATORS(Texture2D)
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
Texture2D::Texture2D(Application* app, const String& name, IHardwareResourceProvider* provider) : Object(app, EGE_OBJECT_UID_TEXTURE_2D), 
                                                                                                  m_name(name), 
                                                                                                  m_width(0), 
                                                                                                  m_height(0), 
                                                                                                  m_format(PF_UNKNOWN),
                                                                                                  m_provider(provider)
{
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
Texture2D::~Texture2D()
{
  // remove render target
  if (NULL != m_target)
  {
    app()->graphics()->removeRenderTarget(m_target->name());
    m_target = NULL;
  }
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
PRenderTarget Texture2D::renderTarget() const 
{ 
  return m_target; 
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
void Texture2D::setRenderTarget(PRenderTarget& target)
{
  m_target = target;
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
s32 Texture2D::width() const 
{ 
  return m_width; 
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
s32 Texture2D::height() const 
{ 
  return m_height; 
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
PixelFormat Texture2D::format() const 
{ 
  return m_format; 
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
const String& Texture2D::name() const 
{ 
  return m_name; 
}
//--------------------------------------------------------------------------------------------------------------------------------------------------------------
